<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kettle 常见问题排除 | kettle.wiki</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/assets/css/0.styles.b63842d3.css" as="style"><link rel="preload" href="/assets/js/app.14130228.js" as="script"><link rel="preload" href="/assets/js/2.e958abea.js" as="script"><link rel="preload" href="/assets/js/12.152d19b1.js" as="script"><link rel="prefetch" href="/assets/js/10.f31b695e.js"><link rel="prefetch" href="/assets/js/11.31d6d8ba.js"><link rel="prefetch" href="/assets/js/13.3d0321f4.js"><link rel="prefetch" href="/assets/js/14.3cbccfb3.js"><link rel="prefetch" href="/assets/js/15.7fb6a005.js"><link rel="prefetch" href="/assets/js/16.7010c77b.js"><link rel="prefetch" href="/assets/js/17.2b182b3b.js"><link rel="prefetch" href="/assets/js/18.9cc97f0c.js"><link rel="prefetch" href="/assets/js/19.5b7f4a84.js"><link rel="prefetch" href="/assets/js/20.d35c2d25.js"><link rel="prefetch" href="/assets/js/21.eb26fe62.js"><link rel="prefetch" href="/assets/js/22.58f5f512.js"><link rel="prefetch" href="/assets/js/23.1c158235.js"><link rel="prefetch" href="/assets/js/24.0c2356d3.js"><link rel="prefetch" href="/assets/js/25.eb3752be.js"><link rel="prefetch" href="/assets/js/26.b1bd13b8.js"><link rel="prefetch" href="/assets/js/27.5061b588.js"><link rel="prefetch" href="/assets/js/28.f3aa2736.js"><link rel="prefetch" href="/assets/js/29.2a10bac8.js"><link rel="prefetch" href="/assets/js/3.a800d23c.js"><link rel="prefetch" href="/assets/js/4.129c6096.js"><link rel="prefetch" href="/assets/js/5.0b42ea20.js"><link rel="prefetch" href="/assets/js/6.c5486a09.js"><link rel="prefetch" href="/assets/js/7.d695c9fe.js"><link rel="prefetch" href="/assets/js/8.ef14eeae.js"><link rel="prefetch" href="/assets/js/9.2383ce54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b63842d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">kettle.wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/home.html" class="sidebar-link">认识Kettle</a></li><li><a href="/quickstart.html" class="sidebar-link">快速开始</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spoon</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/spoon/start.html" class="sidebar-link">起步</a></li><li><a href="/spoon/db-conect.html" class="sidebar-link">数据库链接</a></li><li><a href="/spoon/plugins.html" class="sidebar-link">使用插件</a></li><li><a href="/spoon/repositorie.html" class="sidebar-link">kettle资源库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/step/transformationStep" class="sidebar-heading clickable"><span>转换步骤</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/step/abort.html" class="sidebar-link">Abort中止步骤</a></li><li><a href="/step/addACheckSum.html" class="sidebar-link">添加校验列</a></li><li><a href="/step/addAConstants.html" class="sidebar-link">添加常量</a></li><li><a href="/step/addSequence.html" class="sidebar-link">添加序列</a></li><li><a href="/step/amqpConsumer.html" class="sidebar-link">Amqp消费者</a></li><li><a href="/step/amqpProducer.html" class="sidebar-link">Amqp生产者</a></li><li><a href="/" class="sidebar-link">追加流</a></li><li><a href="/step/copyRowsToResult.html" class="sidebar-link">复制记录到结果</a></li><li><a href="/step/dataValidator.html" class="sidebar-link">数据检验</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>KitChen</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Pan</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Carte</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>高级主题</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>资源下载</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/download.html" class="sidebar-link">驱动包</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>常见问题处理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Q&amp;A/group`s qq Q&amp;A.html" class="sidebar-link">QQ群问题收集</a></li><li><a href="/Q&amp;A/dataIntegrationIssues.html" class="active sidebar-link">Kettle故障排除</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Q&amp;A/dataIntegrationIssues.html#转换步骤和作业条目疑难解答" class="sidebar-link">转换步骤和作业条目疑难解答</a></li><li class="sidebar-sub-header"><a href="/Q&amp;A/dataIntegrationIssues.html#排除数据库连接问题" class="sidebar-link">排除数据库连接问题</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/todolist.html" class="sidebar-link">toDoList</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="kettle-常见问题排除"><a href="#kettle-常见问题排除" class="header-anchor">#</a> Kettle 常见问题排除</h1> <p>请按照这些主题中的建议来帮助解决与Pentaho数据集成相关的常见问题：</p> <ul><li>转换步骤和作业条目疑难解答</li> <li>排除数据库连接</li> <li>Pentaho Server上安排的作业无法在远程Carte服务器上执行转换</li> <li>无法在另一个作业的Carte实例的存储库中运行作业</li> <li>对Pentaho数据服务问题进行故障排除</li> <li>Kitchen和Pan无法从ZIP导出中读取文件</li> <li>使用ODBC</li> <li>编写多个文件时提高性能</li></ul> <h2 id="转换步骤和作业条目疑难解答"><a href="#转换步骤和作业条目疑难解答" class="header-anchor">#</a> 转换步骤和作业条目疑难解答</h2> <p>如果您在转换步骤或作业条目方面遇到问题，请检查这些条件是否适用于您的情况。</p> <h3 id="打开转换或作业时出现“缺少插件”错误"><a href="#打开转换或作业时出现“缺少插件”错误" class="header-anchor">#</a> 打开转换或作业时出现“缺少插件”错误</h3> <p>如果您尝试打开包含未在PDI客户端副本中安装的步骤或条目的转换或作业，则会显示以下错误消息：</p> <p><img src="/image/ssPDIMissingPlugins.png" alt=""></p> <p>要解决此问题，请在PDI客户端中添加步骤或条目，或在市场中找到它并进行安装。有关详细信息，请参阅使用Marketplace安装插件一文。</p> <h3 id="无法执行或修改转换或作业"><a href="#无法执行或修改转换或作业" class="header-anchor">#</a> 无法执行或修改转换或作业</h3> <p>如果您无法执行任何标准转换或作业任务（例如运行，预览，调试，重放，验证，计划，复制，导出或保存），则您没有执行权限。</p> <p>让管理用户检查您的角色是否已被授予执行权限。</p> <h3 id="步骤已经在画布错误"><a href="#步骤已经在画布错误" class="header-anchor">#</a> 步骤已经在画布错误</h3> <p>如果在PDI客户端的画布上隐藏了一个步骤，则在尝试使用其转换时，您可能会收到“Step is Already on Canvas”错误消息。</p> <p>无论步骤是隐藏还是显示在画布中，它都会在数据集成透视图的“ 视图”选项卡中的  转换下的“ 步骤”文件夹中列出。要重新显示画布上的隐藏步骤，请将其从“ 视图”选项卡中的“ 步骤”文件夹拖到画布上。</p> <h2 id="排除数据库连接问题"><a href="#排除数据库连接问题" class="header-anchor">#</a> 排除数据库连接问题</h2> <p>如果您在PDI中遇到数据库连接问题，请检查以下条件是否适用于您的情况：</p> <h3 id="不支持的数据库"><a href="#不支持的数据库" class="header-anchor">#</a> 不支持的数据库</h3> <p>可以通过ODBC或JDBC连接使用通用数据库驱动程序从不受支持的数据库中读取数据。如果要访问尚未包含在<a href="">受支持组件</a>列表中的数据库类型，请与Pentaho联系  。</p> <p>您可以在位于`````... \ design-tools \ data-integration```下的lib 目录中  添加或替换数据库驱动程序文件  。</p> <h3 id="从单个表读取和更新时的数据库锁定"><a href="#从单个表读取和更新时的数据库锁定" class="header-anchor">#</a> 从单个表读取和更新时的数据库锁定</h3> <p>如果您在转换中创建，读取和更新单个表的步骤，您可能会遇到数据库锁定或处理速度变慢。在单个转换中读取和更新表上的行可能导致数据库停止更新。</p> <p>例如，如果您有一个从表中的行读取的步骤（表输入  步骤），并且您需要使用更新  步骤更新转换，则可能会导致锁定问题，尤其是对于MS SQL数据库。应避免在同一个表中读取和更新同一转换中的行。</p> <p>与所有数据库兼容的通用解决方案是复制要读取/更新的表，然后创建单独的读取/更新步骤。安排在转换中按顺序执行的步骤，每个步骤在同一个表的不同但相同的版本上。调整数据库行锁定参数或机制也将解决此问题。</p> <h3 id="强制pdi在参数化sql查询中使用date而不是timestamp"><a href="#强制pdi在参数化sql查询中使用date而不是timestamp" class="header-anchor">#</a> 强制PDI在参数化SQL查询中使用DATE而不是TIMESTAMP</h3> <p>如果查询优化器错误地使用谓词TIMESTAMP，那是因为JDBC驱动程序/数据库将数据类型从TIMESTAMP转换为DATE。在某些情况下，此转换会阻止数据库的查
询优化器使用正确的索引。例如，Oracle可能声明它无法使用索引，并生成以下错误消息：</p> <div class="language-$xslt extra-class"><pre class="language-text"><code>The predicate DATE used at line ID 1 of the execution plan contains an implicit
   data type conversion on indexed column DATE. This implicit data type conversion prevents
   the optimizer from selecting indices on table A.
  
</code></pre></div><p>要解决此问题，使用Select Values步骤，并设置Precision到1和Value到DATE。这些更改会强制将参数设置为DATE而不是TIMESTAMP。</p> <h3 id="pdi无法识别对表所做的更改"><a href="#pdi无法识别对表所做的更改" class="header-anchor">#</a> PDI无法识别对表所做的更改</h3> <p>如果在PDI客户端之外编辑表布局，则PDI不会发现任何字段更改，删除或添加。</p> <p>清除缓存可解决此问题。需要清除缓存中与数据库相关的元信息（每个使用的数据库表中的字段名称及其类型）。PDI具有此缓存以提高处理速度。执行以下步
骤以从PDI客户端中清除缓存中的此信息：</p> <ol><li>选择连接。</li> <li><strong>选择工具&gt;数据库&gt;清除缓存或数据库连接&gt;清除完整的数据库缓存。</strong></li></ol> <h3 id="pentaho-server上安排的作业无法在远程carte服务器上执行转换"><a href="#pentaho-server上安排的作业无法在远程carte服务器上执行转换" class="header-anchor">#</a> Pentaho Server上安排的作业无法在远程Carte服务器上执行转换</h3> <p>尝试安排作业在远程Carte服务器上运行时，您可能会看到类似于以下消息的错误：</p> <div class="language- extra-class"><pre class="language-text"><code>ERROR 11-05 09:33:06,031 - !UserRoleListDelegate.ERROR_0001_UNABLE_TO_INITIALIZE_USER_ROLE_LIST_WEBSVC!
        com.sun.xml.ws.client.ClientTransportException: The server sent HTTP status code 401: Unauthorized

</code></pre></div><p>您需要进行以下配置更改以远程执行预定作业：</p> <blockquote><p>将Pentaho Server用作动态Carte集群中的负载均衡器也需要此过程。</p></blockquote> <ol><li>停止Pentaho和Carte服务器。</li> <li>将repositories.xml 文件从工作站上的.kettle文件夹复制到Carte slave上的相同位置。如果没有此文件，Carte slave将无法连接到Pentaho Repository以检索PDI内容。</li> <li>在文本编辑器中打开/pentaho/server/pentaho-server/tomcat/webapps/pentaho/WEB-INF/web.xml文件。</li> <li>找到该  Proxy Trusting Filter 部分，并将您的Carte服务器的IP地址添加到该param-value 元素。以下代码块是该Proxy Trusting Filter 部分的示例  ：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;filter&gt;
    &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.pentaho.platform.web.http.filters.ProxyTrustingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;TrustedIpAddrs&lt;/param-name&gt;
      &lt;param-value&gt;127.0.0.1,192.168.0.1&lt;/param-value&gt;
      &lt;description&gt;Comma separated list of IP addresses of a trusted hosts.&lt;/description&gt;
    &lt;/init-param&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;NewSessionPerRequest&lt;/param-name&gt;
      &lt;param-value&gt;true&lt;/param-value&gt;
      &lt;description&gt;true to never re-use an existing IPentahoSession in the HTTP session; needs to be true to work around code put in for BISERVER-2639&lt;/description&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;
</code></pre></div><ol start="5"><li>取消注释和标记之间的代理信任过滤器映射，如以下示例代码块所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- begin trust --&gt; 
&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/authorizationPolicy&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/roleBindingDao&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/userRoleListService&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/unifiedRepository&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/userRoleService&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/Scheduler&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;Proxy Trusting Filter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/webservices/repositorySync&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;!-- end trust --&gt;
</code></pre></div><ol start="6"><li><p>保存并关闭该文件，然后 在运行Carte服务器的计算机上编辑carte.sh或Carte.bat启动脚本。</p></li> <li><p>添加-Dpentaho.repository.client.attemptTrust=true到文件底部的java行，如下面的示例代码行所示：</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>java $OPT -Dpentaho.repository.client.attemptTrust=true org.pentaho.di.www.Carte &quot;${1+$@}&quot;

</code></pre></div><ol start="8"><li>保存并关闭文件。</li> <li>启动您的Carte和Pentaho服务器。</li></ol> <p><strong>您现在可以安排作业在远程Carte实例上运行。</strong></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Q&amp;A/group`s qq Q&amp;A.html" class="prev">QQ群问题收集</a></span> <span class="next"><a href="/todolist.html">toDoList</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.14130228.js" defer></script><script src="/assets/js/2.e958abea.js" defer></script><script src="/assets/js/12.152d19b1.js" defer></script>
  </body>
</html>
